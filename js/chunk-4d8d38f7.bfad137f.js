(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d8d38f7"],{"0ac0":function(t,e,n){},"20bb":function(t,e,n){},2423:function(t,e,n){"use strict";n.d(e,"f",(function(){return a})),n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return i})),n.d(e,"a",(function(){return s})),n.d(e,"h",(function(){return o})),n.d(e,"b",(function(){return u})),n.d(e,"g",(function(){return l})),n.d(e,"i",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"j",(function(){return h}));var r=n("b775"),a=function(t){return Object(r["a"])({method:"GET",url:"/v1_0/articles",params:t})},c=function(t){return Object(r["a"])({method:"GET",url:"/v1_0/articles/".concat(t)})},i=function(t){return Object(r["a"])({method:"POST",url:"/v1_0/article/collections",data:{target:t}})},s=function(t){return Object(r["a"])({method:"DELETE",url:"/v1_0/article/collections/".concat(t)})},o=function(t){return Object(r["a"])({method:"POST",url:"/v1_0/article/likings",data:{target:t}})},u=function(t){return Object(r["a"])({method:"DELETE",url:"/v1_0/article/likings/".concat(t)})},l=function(t){return Object(r["a"])({method:"GET",url:"/v1_0/comments",params:t})},d=function(t){return Object(r["a"])({method:"POST",url:"/v1_0/comment/likings",data:{target:t}})},f=function(t){return Object(r["a"])({method:"DELETE",url:"/v1_0/comment/likings/".concat(t)})},h=function(t){return Object(r["a"])({method:"POST",url:"/v1_0/comments",data:t})}},"408a":function(t,e,n){var r=n("e330");t.exports=r(1..valueOf)},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var r=n("e330"),a=n("1d80"),c=n("577e"),i=n("5899"),s=r("".replace),o="["+i+"]",u=RegExp("^"+o+o+"*"),l=RegExp(o+o+"*$"),d=function(t){return function(e){var n=c(a(e));return 1&t&&(n=s(n,u,"")),2&t&&(n=s(n,l,"")),n}};t.exports={start:d(1),end:d(2),trim:d(3)}},"7abe":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-container"},[n("van-nav-bar",{staticClass:"app-nav-bar",scopedSlots:t._u([{key:"left",fn:function(){return[n("van-button",{staticClass:"search-btn",attrs:{icon:"search",type:"info",round:"",size:"small",to:{name:"search"}}},[t._v("搜索 ")])]},proxy:!0},{key:"right",fn:function(){return[n("van-button",{staticClass:"channel-edit-btn",attrs:{icon:"apps-o"},on:{click:function(e){t.isChannelEditShow=!0}}})]},proxy:!0}])}),n("van-tabs",{staticClass:"channel-tabs",attrs:{animated:"",swipeable:""},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.channels,(function(t){return n("van-tab",{key:t.id,attrs:{title:t.name}},[n("ArticleList",{attrs:{channel:t}})],1)})),1),n("van-popup",{staticClass:"channel-edit-popup",style:{height:"100%"},attrs:{position:"bottom",closeable:"","get-container":"body","close-icon-position":"top-left"},model:{value:t.isChannelEditShow,callback:function(e){t.isChannelEditShow=e},expression:"isChannelEditShow"}},[n("channel-edit",{attrs:{"my-channels":t.channels,channelActiveIndex:t.active}})],1)],1)},a=[],c=n("5530"),i=n("1da1"),s=(n("96cf"),n("c24f")),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"articleList",staticClass:"article-list"},[n("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.pulldownLoading,callback:function(e){t.pulldownLoading=e},expression:"pulldownLoading"}},[n("van-list",{attrs:{finished:t.finished,"loading-text":"加载中","finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(t,e){return n("article-item",{key:e,attrs:{article:t}})})),1)],1)],1)},u=[],l=n("2909"),d=n("2423"),f=n("d399"),h=n("6ea2"),m=n("2ef0"),p={name:"ArticleList",components:{ArticleItem:h["a"]},props:{channel:{type:Object,required:!0}},data:function(){return{list:[],loading:!1,finished:!1,pre_timestamp:null,pulldownLoading:!1,scrollTop:0}},methods:{onLoad:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("自动触发，请求数据"),e.next=3,Object(d["f"])({channel_id:t.channel.id,timestamp:null===t.pre_timestamp?Date.now():t.pre_timestamp});case 3:r=e.sent,(n=t.list).push.apply(n,Object(l["a"])(r.data.data.results)),t.loading=!1,r.data.data.results.length?t.pre_timestamp=r.data.data.pre_timestamp:t.finished=!0;case 7:case"end":return e.stop()}}),e)})))()},onRefresh:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("下拉刷新事件"),e.next=3,Object(d["f"])({channel_id:t.channel.id,timestamp:Date.now()});case 3:r=e.sent,(n=t.list).unshift.apply(n,Object(l["a"])(r.data.data.results)),t.pulldownLoading=!1,Object(f["a"])({message:"刷新成功，更新了".concat(r.data.data.results.length,"条数据")}),t.pre_timestamp=r.data.data.pre_timestamp;case 8:case"end":return e.stop()}}),e)})))()}},mounted:function(){var t=this,e=this.$refs.articleList;e.onscroll=Object(m["debounce"])((function(){t.scrollTop=e.scrollTop}),100)},activated:function(){this.$refs.articleList.scrollTop=this.scrollTop}},b=p,v=(n("7ced"),n("2877")),g=Object(v["a"])(b,o,u,!1,null,"0f29722e",null),O=g.exports,_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"channel-edit"},[n("van-cell",{attrs:{center:"",border:!1},scopedSlots:t._u([{key:"title",fn:function(){return[n("div",{staticClass:"channel-title"},[t._v(" 我的频道 ")])]},proxy:!0},{key:"default",fn:function(){return[n("van-button",{staticClass:"edit-btn",attrs:{type:"danger",round:"",size:"small"},on:{click:function(e){t.isEdit=!t.isEdit}}},[t._v(" "+t._s(t.isEdit?"完成":"编辑")+" ")])]},proxy:!0}])}),n("van-grid",{attrs:{gutter:10,clickable:""}},t._l(t.myChannels,(function(e,r){return n("van-grid-item",{key:r,staticClass:"grid-item",class:{active:r===t.channelActiveIndex},attrs:{icon:t.isEdit&&0!==r?"close":"",text:e.name},on:{click:function(e){return t.onUserChannelClick(r)}}})})),1),n("van-cell",{staticStyle:{"margin-top":"20px"},attrs:{center:"",border:!1},scopedSlots:t._u([{key:"title",fn:function(){return[n("div",{staticClass:"channel-title"},[t._v("频道推荐")])]},proxy:!0}])}),n("van-grid",{attrs:{gutter:10}},t._l(t.recommendChannels,(function(e,r){return n("van-grid-item",{key:r,staticClass:"grid-item",attrs:{text:e.name},on:{click:function(n){return t.onAddChannel(e)}}})})),1)],1)},E=[],x=(n("a9e3"),n("a434"),n("4de4"),n("d3b7"),n("7db0"),n("b775")),j=function(){return Object(x["a"])({method:"GET",url:"/v1_0/channels"})},C=function(t){return Object(x["a"])({method:"PATCH",url:"/v1_0/user/channels",data:t})},k=function(t){return Object(x["a"])({method:"DELETE",url:"/v1_0/user/channels/".concat(t)})},w=n("986e"),y=n("2f62"),T=n("5d2d"),A={name:"ChannelEdit",props:{myChannels:{type:Array,required:!0},channelActiveIndex:{type:Number,required:!0}},data:function(){return{allChannels:[],isEdit:!1}},methods:{loadAllChannels:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:n=e.sent,t.allChannels=n.data.data.channels;case 4:case"end":return e.stop()}}),e)})))()},onAddChannel:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.myChannels.push(t),!e.user){n.next=6;break}return n.next=4,C({channels:[{id:t.id,seq:e.myChannels.length}]});case 4:n.next=7;break;case 6:Object(T["c"])("user-channels",e.myChannels);case 7:case"end":return n.stop()}}),n)})))()},onUserChannelClick:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.isEdit||0===t){n.next=11;break}if(t<=e.channelActiveIndex&&w["a"].emit("updateActive",e.channelActiveIndex-1),r=e.myChannels.splice(t,1),!e.user){n.next=8;break}return n.next=6,k(r[0].id);case 6:n.next=9;break;case 8:Object(T["c"])("user-channels",e.myChannels);case 9:n.next=12;break;case 11:e.isEdit&&0===t?Object(f["a"])({message:"推荐频道无法删除",position:"top"}):w["a"].emit("changeChannel",t);case 12:case"end":return n.stop()}}),n)})))()}},computed:Object(c["a"])(Object(c["a"])({},Object(y["b"])(["user"])),{},{recommendChannels:function(){var t=this;return this.allChannels.filter((function(e){return!t.myChannels.find((function(t){return t.id===e.id}))}))}}),created:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.loadAllChannels();case 2:case"end":return e.stop()}}),e)})))()}},I=A,S=(n("9d6e"),Object(v["a"])(I,_,E,!1,null,"7a6749d0",null)),L=S.exports,N={name:"HomeIndex",components:{ArticleList:O,ChannelEdit:L},data:function(){return{active:0,channels:[],isChannelEditShow:!1}},created:function(){this.loadChannels()},mounted:function(){var t=this;w["a"].on("changeChannel",(function(e){t.active=e,t.isChannelEditShow=!1})),w["a"].on("updateActive",(function(e){t.active=e}))},methods:{loadChannels:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r,a,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=[],!t.user){e.next=8;break}return e.next=4,Object(s["d"])();case 4:r=e.sent,n=r.data.data.channels,e.next=17;break;case 8:if(a=Object(T["a"])("user-channels"),!a){e.next=13;break}n=a,e.next=17;break;case 13:return e.next=15,Object(s["d"])();case 15:c=e.sent,n=c.data.data.channels;case 17:t.channels=n;case 18:case"end":return e.stop()}}),e)})))()}},computed:Object(c["a"])({},Object(y["b"])(["user"]))},R=N,G=(n("91a3"),Object(v["a"])(R,r,a,!1,null,"4bf9ca42",null));e["default"]=G.exports},"7ced":function(t,e,n){"use strict";n("20bb")},"7db0":function(t,e,n){"use strict";var r=n("23e7"),a=n("b727").find,c=n("44d2"),i="find",s=!0;i in[]&&Array(1)[i]((function(){s=!1})),r({target:"Array",proto:!0,forced:s},{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),c(i)},"91a3":function(t,e,n){"use strict";n("0ac0")},"9d6e":function(t,e,n){"use strict";n("c685")},a9e3:function(t,e,n){"use strict";var r=n("83ab"),a=n("da84"),c=n("e330"),i=n("94ca"),s=n("6eeb"),o=n("1a2d"),u=n("7156"),l=n("3a9b"),d=n("d9b5"),f=n("c04e"),h=n("d039"),m=n("241c").f,p=n("06cf").f,b=n("9bf2").f,v=n("408a"),g=n("58a8").trim,O="Number",_=a[O],E=_.prototype,x=a.TypeError,j=c("".slice),C=c("".charCodeAt),k=function(t){var e=f(t,"number");return"bigint"==typeof e?e:w(e)},w=function(t){var e,n,r,a,c,i,s,o,u=f(t,"number");if(d(u))throw x("Cannot convert a Symbol value to a number");if("string"==typeof u&&u.length>2)if(u=g(u),e=C(u,0),43===e||45===e){if(n=C(u,2),88===n||120===n)return NaN}else if(48===e){switch(C(u,1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+u}for(c=j(u,2),i=c.length,s=0;s<i;s++)if(o=C(c,s),o<48||o>a)return NaN;return parseInt(c,r)}return+u};if(i(O,!_(" 0o1")||!_("0b1")||_("+0x1"))){for(var y,T=function(t){var e=arguments.length<1?0:_(k(t)),n=this;return l(E,n)&&h((function(){v(n)}))?u(Object(e),n,T):e},A=r?m(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),I=0;A.length>I;I++)o(_,y=A[I])&&!o(T,y)&&b(T,y,p(_,y));T.prototype=E,E.constructor=T,s(a,O,T)}},c24f:function(t,e,n){"use strict";n.d(e,"f",(function(){return a})),n.d(e,"g",(function(){return c})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return f})),n.d(e,"e",(function(){return s})),n.d(e,"i",(function(){return o})),n.d(e,"h",(function(){return u}));var r=n("b775"),a=function(t){return Object(r["a"])({method:"POST",url:"/v1_0/authorizations",data:t})},c=function(t){return Object(r["a"])({method:"GET",url:"/v1_0/sms/codes/".concat(t)})},i=function(){return Object(r["a"])({method:"GET",url:"/v1_0/user"})},s=function(){return Object(r["a"])({method:"GET",url:"/v1_0/user/profile"})},o=function(t){return Object(r["a"])({method:"PATCH",url:"/v1_0/user/profile",data:t})},u=function(t){return Object(r["a"])({method:"PATCH",url:"/v1_0/user/photo",data:t})},l=function(){return Object(r["a"])({method:"GET",url:"/v1_0/user/channels"})},d=function(t){return Object(r["a"])({method:"POST",url:"/v1_0/user/followings",data:{target:t}})},f=function(t){return Object(r["a"])({method:"DELETE",url:"/v1_0/user/followings/".concat(t)})}},c685:function(t,e,n){}}]);
//# sourceMappingURL=chunk-4d8d38f7.bfad137f.js.map